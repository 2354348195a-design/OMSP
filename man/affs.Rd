% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/affs.R
\name{affs}
\alias{affs}
\title{Construct Affinity Matrix from Input Data}
\usage{
affs(x, na.action = na.omit)
}
\arguments{
\item{x}{A numeric matrix or data frame where each row represents a sample.}

\item{na.action}{A function defining how to handle missing values.
Default is \code{na.omit}, which removes rows containing NA.}
}
\value{
An m Ã— m affinity matrix, where m is the number of samples.
}
\description{
This function computes an affinity (similarity) matrix based on pairwise
distances between samples. The affinity is calculated using a Gaussian kernel
with locally adaptive scaling for each sample.
}
\details{
The function performs the following steps:
\itemize{
\item Removes missing values using \code{na.action}.
\item Computes the pairwise squared Euclidean distance matrix using
fast matrix operations.
\item For each sample, estimates a local scale parameter as the median
of the 5 smallest non-zero distances.
\item Constructs an affinity matrix using a Gaussian kernel:
\deqn{K_{ij} = \exp \left( - \frac{d_{ij}}{s_i s_j} \right)}
where \eqn{d_{ij}} is the squared Euclidean distance and
\eqn{s_i} is the local scaling factor for sample \eqn{i}.
}

This approach is similar to the adaptive Gaussian kernel used in
self-tuning spectral clustering.
}
\examples{
\dontrun{
set.seed(1)
x <- matrix(rnorm(50), nrow = 10)
K <- affs(x)
}

}
